Are Higher Movie Budgets Associated with Higher IMDB Ratings for Movies Made from 1980-2005?
========================================================
We load the `ggplot2` R package first, then the data.
```{r}
if (!is.element("ggplot2", rownames(installed.packages()))) {
  install.packages("ggplot2")
}
library(ggplot2)
data(movies)
options(width = 150)
```



Data Cleaning
--------------------------------------------------------
Let's only consider movies between 1980 and 2005 who have non-missing non-zero budgets.
```{r fig.width=6, fig.height=6}
movies <- subset(movies, movies$budget != 0 & !is.na(movies$budget))
movies <- subset(movies, movies$year >= 1980 & movies$year <= 2005)
```

You should always explore the data before doing any kind of statistical analysis.  Here is some information on the top 10 most expensive movies in the dataset:
```{r}
movies[order(movies$budget, decreasing=TRUE)[1:10], 1:6]
```

Here is some information on the top 10 highest rated movies in the dataset:
```{r}
movies[order(movies$rating, decreasing=TRUE)[1:10], 1:6]
```



Budgets and Ratings
--------------------------------------------------------
Let's look at a histogram of movie budgets.  The data is extremely right skewed: 
```{r fig.width=6, fig.height=6}
movies <- subset(movies, movies$budget != 0 & !is.na(movies$budget))
movies <- subset(movies, movies$year >= 1980 & movies$year <= 2005)
hist(movies$budget, xlab="movie budget in USD", main="Movie Budgets")
```


What's often done in statistics/economics is to consider the log of the data to spread it out and consider "orders of magnitude".  Let's take log base 10 so that we easily mark thousands, millions, etc:

```{r fig.width=6, fig.height=6}
movies$log10.budget <- log10(movies$budget)
hist(movies$log10.budget, xlab="log10 of movie budget in USD", main="log Base 10 of Movie Budgets")
```

Here are the average IMDB user ratings
```{r fig.width=6, fig.height=6}
hist(movies$rating, xlab="IMDB rating", main="Movie Rating")
```


Relationship 
--------------------------------------------------------
And here is a scatter plot of movie budgets vs ratings, along with the regression line.  
```{r fig.width=6, fig.height=6}
plot(movies$log10.budget, movies$rating, xlab="log10 of movie budget in USD", ylab="IMDB rating")
regression <- lm(movies$rating ~ movies$log10.budget)
abline(regression, col="red", lwd=3)
```

It looks negatively sloped!  i.e. assuming a linear model, as movie budgets go up its IMDB rating goes down.  

```{r fig.width=6, fig.height=6}
summary(regression)
```

So the interpretation is: for 
* every increase of 1 in $\log_{10}$ of the movie budget
* or stated differently, every multiplicative increase of $10^1 = 10$ in the movie budget

we observed a decrease of -0.2170 in the IMDB rating of the movie. If the assumptions of linear regression hold, then a 95\% confidence interval of this estimate is $\mbox{point estimate} \pm 1.96 \times SE = -0.2170 \pm 1.96 \times 0.01963 = (-0.2555, -0.1785)$


Diagnostic Plots
--------------------------------------------------------
However, we must verify the assumptions of linear regression to be able to trust the confidence intervals and hypothesis tests. Here is a histogram of the residuals $e_i = y_i - \widehat{y}_i$.  They are not quite centered and symmetric about 0.
```{r fig.width=6, fig.height=6}
residuals <- residuals(regression)
hist(residuals, main="Residuals", breaks=20)
abline(v=0, lwd=2, lty=2)
```

Taking a look at a QQ-plot of the residuals, they deviate a bit from being normal.  
```{r fig.width=6, fig.height=6}
qqnorm(residuals)
qqline(residuals)
```

Finally, we have a residual plot to verify the assumption of constant variance.  The red line is a ``smoothing function'' that goes through the points and attempts to separate an underlying trend from the noise.  
```{r fig.width=6, fig.height=6}
plot(movies$log10.budget, residuals, cex=0.5, xlab="log base 10 of movie budget")
abline(h=0, lwd=2, lty=2)
lines(lowess(movies$log10.budget, residuals), col="red", lwd=2)
```


What are some issues with the analysis?
--------------------------------------------------------



